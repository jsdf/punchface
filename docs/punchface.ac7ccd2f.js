parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"rrZw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t){this.x=0,this.y=0,this.z=0,t&&(this.x=t.x,this.y=t.y,this.z=t.z)}return t.prototype.origin=function(){this.x=0,this.y=0,this.z=0},t.prototype.init=function(t,i,s){this.x=t,this.y=i,this.z=s},t.prototype.clone=function(){return new t(this)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},t.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},t.prototype.normalise=function(){if(0===this.x&&0===this.y&&0===this.z)return this;var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.x/=t,this.y/=t,this.z/=t,this},t.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},t.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},t.prototype.mulScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t.prototype.divScalar=function(t){return this.x/=t,this.y/=t,this.z/=t,this},t.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)+Math.pow(this.z-t.z,2))},t.prototype.directionTo=function(i){return new t(i).sub(this).normalise()},t.prototype.toJSON=function(){return{x:this.x,y:this.y,z:this.z}},t.prototype.toString=function(){return"{x:"+this.x.toFixed(2)+", y:"+this.y.toFixed(2)+", z:"+this.z.toFixed(2)+"}"},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},t.prototype.xy=function(){return{x:this.x,y:this.y}},t}();exports.Vec3d=t;
},{}],"JHut":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,o){this.min=t,this.max=o}return t.prototype.fromCenteredBox=function(t){this.max.copyFrom(t).divScalar(2),this.min.copyFrom(this.max).mulScalar(-1)},t.prototype.clone=function(){return new t(this.min.clone(),this.max.clone())},t}();exports.Bounds3d=t;
},{}],"uSNF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Vec3d"),t=require("./Bounds"),n=0,o=function(){function o(){this.position=new e.Vec3d,this.bounds=new t.Bounds3d(new e.Vec3d,new e.Vec3d),this.id=n++,this.zLayer=0}return o.prototype.update=function(e){},o.prototype.render=function(e,t){},o.prototype.renderDebug=function(e,t){var n=e.getScreenPos(this);t.font="8px Lucida Grande",t.fillStyle="red",t.fillText(this.toString()+" "+this.position.toString(),n.x,n.y);var o=this.bounds.min.clone();o.z=0;var i=this.bounds.max.clone();i.z=0;var r=e.view.getScreenPos(this.position.clone().add(o)),s=e.view.getScreenPos(this.position.clone().add(i)).sub(r);t.strokeRect(r.x,r.y,s.x,s.y)},o.prototype.toString=function(){return"{"+this.constructor.name+":"+this.id+"}"},o}();exports.GameObject=o;
},{"./Vec3d":"rrZw","./Bounds":"JHut"}],"z0VK":[function(require,module,exports) {
module.exports="/punchface/walk1.e46eecdd.png";
},{}],"tcX5":[function(require,module,exports) {
module.exports="/punchface/walk2.c0a183d8.png";
},{}],"hRh1":[function(require,module,exports) {
module.exports="/punchface/walk3.222dac54.png";
},{}],"RY0n":[function(require,module,exports) {
module.exports="/punchface/walk4.12054129.png";
},{}],"OiO6":[function(require,module,exports) {
module.exports="/punchface/idle1.f6f85709.png";
},{}],"OMCs":[function(require,module,exports) {
module.exports="/punchface/idle2.c879b102.png";
},{}],"s4jY":[function(require,module,exports) {
module.exports="/punchface/idle3.d0807f0e.png";
},{}],"Ivyb":[function(require,module,exports) {
module.exports="/punchface/idle4.fe3e8a5c.png";
},{}],"qNdi":[function(require,module,exports) {
module.exports="/punchface/sewer1.9bbd63a2.png";
},{}],"FJzI":[function(require,module,exports) {
module.exports="/punchface/sewer2.9bbd63a2.png";
},{}],"CZ48":[function(require,module,exports) {
module.exports="/punchface/sewer3.b5515139.png";
},{}],"SLDe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.images={walk1:require("./assets/walk1.png"),walk2:require("./assets/walk2.png"),walk3:require("./assets/walk3.png"),walk4:require("./assets/walk4.png"),idle1:require("./assets/idle1.png"),idle2:require("./assets/idle2.png"),idle3:require("./assets/idle3.png"),idle4:require("./assets/idle4.png"),sewer1:require("./assets/sewer1.png"),sewer2:require("./assets/sewer2.png"),sewer3:require("./assets/sewer3.png")},exports.idleAnim=[exports.images.idle1,exports.images.idle2,exports.images.idle3,exports.images.idle4],exports.walkAnim=[exports.images.walk1,exports.images.walk2,exports.images.walk3,exports.images.walk4],exports.sewerAnim=[exports.images.sewer1,exports.images.sewer2,exports.images.sewer3];
},{"./assets/walk1.png":"z0VK","./assets/walk2.png":"tcX5","./assets/walk3.png":"hRh1","./assets/walk4.png":"RY0n","./assets/idle1.png":"OiO6","./assets/idle2.png":"OMCs","./assets/idle3.png":"s4jY","./assets/idle4.png":"Ivyb","./assets/sewer1.png":"qNdi","./assets/sewer2.png":"FJzI","./assets/sewer3.png":"CZ48"}],"gTgb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./Vec3d"),i=1/60,e=4,o=-300,s=0,n=function(){function i(i){this.id=s++,this.enabled=!0,this.prevPosition=new t.Vec3d,this.velocity=new t.Vec3d,this.nonIntegralVelocity=new t.Vec3d,this.acceleration=new t.Vec3d,this.nonIntegralAcceleration=new t.Vec3d,this.prevAcceleration=new t.Vec3d,this.obj=i.obj,this.mass=i.mass,this.massInverse=1/i.mass,this.radius=i.radius,this.radiusSquared=Math.pow(i.radius,2)}return Object.defineProperty(i.prototype,"position",{get:function(){return this.obj.position},enumerable:!0,configurable:!0}),i.prototype.integrateMotionSemiImplicitEuler=function(i,e){var o=new t.Vec3d;this.acceleration.mulScalar(this.massInverse),this.nonIntegralAcceleration=this.acceleration,this.acceleration.mulScalar(i),this.nonIntegralVelocity.add(this.acceleration),this.velocity.copyFrom(this.nonIntegralVelocity),this.velocity.mulScalar(i),this.velocity.mulScalar(e),o.copyFrom(this.position),o.add(this.velocity),this.prevPosition.copyFrom(this.position),this.position.copyFrom(o),this.prevAcceleration.copyFrom(this.acceleration),this.acceleration.origin()},i.prototype.update=function(){var i=new t.Vec3d({x:0,y:o*this.mass,z:0});this.applyForce(i)},i.prototype.applyForce=function(t){this.acceleration.add(t)},i.prototype.toString=function(){return"{"+this.constructor.name+":"+this.id+"}"},i}();function c(t,i){t.position.y-t.radius<i&&(t.position.y=i+t.radius,t.nonIntegralVelocity.y=0)}function a(t,i,e){t.position.z-t.radius<i&&(t.position.z=i+t.radius,t.nonIntegralVelocity.z=0),t.position.z+t.radius>e&&(t.position.z=e-t.radius,t.nonIntegralVelocity.z=0)}exports.PhysBody=n;var r=function(){function t(){this.accumulatedTime=0,this.clock=0,this.viscosity=.01,this.simulationRate=1,this.timeScale=1,this.dynamicTimestep=!0,this.bodies=[],this.floorHeight=-100,this.zMin=-235,this.zMax=-25}return t.prototype.integrateBodies=function(t,i){for(var e=0,o=this.bodies;e<o.length;e++){(l=o[e]).enabled&&l.update(t,i)}for(var s=0,n=this.bodies;s<n.length;s++){(l=n[s]).enabled&&l.integrateMotionSemiImplicitEuler(t,i)}for(var r=0,h=this.bodies;r<h.length;r++){var l;c(l=h[r],this.floorHeight),a(l,this.zMin,this.zMax)}},t.prototype.step=function(t){var o,s,n,c;if(0==this.clock&&(this.clock=t),o=t,(n=(o=this.dynamicTimestep?o:this.clock+16.667*this.timeScale*this.simulationRate)-this.clock)>0){n*=.001,c=1-this.viscosity,this.clock=o,this.accumulatedTime<1?this.accumulatedTime=this.accumulatedTime+n:console.log("physics: accumulated too much time, not accumulating any more\n");var a=0;for(s=i*this.timeScale;this.accumulatedTime>=s&&a<e;){this.integrateBodies(s,c),this.accumulatedTime=this.accumulatedTime-s,a++;break}}},t}();exports.Physics=r;
},{"./Vec3d":"rrZw"}],"UnXq":[function(require,module,exports) {
"use strict";function e(){var e=document.getElementById("viewport");if(!(e instanceof HTMLCanvasElement))throw new Error("die");return e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getImage=function(){var e=new Map;return function(r){if(""!==r){var n=e.get(r);if(n)return n.image;var t={image:null},o=new Image;return o.onload=function(){t.image=o},o.onerror=function(){throw new Error("failed to load "+r)},o.src=r,e.set(r,t),null}}}(),exports.getCanvas=e;
},{}],"lbff":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),e=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("./GameObject"),i=require("./assets"),n=require("./Vec3d"),o=require("./Physics"),s=e(require("./utils")),u=1,a=function(e){function r(){var t=e.call(this)||this;return t.anim=i.idleAnim,t.physBody=new o.PhysBody({obj:t,mass:200,radius:50}),t.position.y=-600,t.bounds.fromCenteredBox(new n.Vec3d({x:118,y:116,z:50})),t}return t(r,e),r.prototype.isOnGround=function(t){return this.physBody.position.y-this.physBody.radius<=t.physics.floorHeight+.001},r.prototype.update=function(t){var e=t.input.direction.clone();e.mulScalar(u);var r=this.isOnGround(t);r||(e.z=0),this.position.add(e),t.input.jump&&r&&this.physBody.applyForce(new n.Vec3d({x:0,y:1e4,z:0}).mulScalar(this.physBody.mass)),t.input.direction.magnitude()>0&&r?this.anim=i.walkAnim:this.anim=i.idleAnim},r.prototype.render=function(t,e){var r=s.getImage(this.anim[t.frameNumber%this.anim.length]),i=t.getScreenPos(this);r&&e.drawImage(r,i.x-r.width/2,i.y-r.height/2)},r}(r.GameObject);exports.Player=a;
},{"./GameObject":"uSNF","./assets":"SLDe","./Vec3d":"rrZw","./Physics":"gTgb","./utils":"UnXq"}],"zFH5":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),e=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("./GameObject"),n=e(require("./utils")),o=function(e){function r(t){var r=e.call(this)||this;return r.anim=t,r.zLayer=-1/0,r}return t(r,e),r.prototype.update=function(t){},r.prototype.render=function(t,e){var r=n.getImage(this.anim[t.frameNumber%this.anim.length]),o=t.getScreenPos(this);r&&e.drawImage(r,o.x,o.y)},r}(r.GameObject);exports.Background=o;
},{"./GameObject":"uSNF","./utils":"UnXq"}],"tde3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Vec3d"),t=function(){function t(){this.keysDown=new Set,this.keysTriggered=new Set,this.direction=new e.Vec3d,this.jump=!1}return t.prototype.onKeyDown=function(e){this.keysDown.add(e),this.keysTriggered.add(e)},t.prototype.onKeyUp=function(e){this.keysDown.delete(e),this.keysTriggered.delete(e)},t.prototype.update=function(){this.direction.origin(),this.jump=!1,this.keysDown.has("d")&&(this.direction.x+=1),this.keysDown.has("a")&&(this.direction.x+=-1),this.keysDown.has("w")&&(this.direction.z+=1),this.keysDown.has("s")&&(this.direction.z+=-1),(this.keysTriggered.has("c")||this.keysTriggered.has("n"))&&(this.jump=!0),this.keysTriggered.clear()},t}();exports.Input=t;
},{"./Vec3d":"rrZw"}],"bVh3":[function(require,module,exports) {
"use strict";function t(t,r,i){return t*(1-i)+r*i}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function r(t){this.x=0,this.y=0,t&&(this.x=t.x,this.y=t.y)}return r.prototype.clone=function(){return new r(this)},r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},r.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},r.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},r.prototype.normalise=function(){if(0===this.x&&0===this.y)return this;var t=Math.sqrt(this.x*this.x+this.y*this.y);return this.x/=t,this.y/=t,this},r.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},r.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this},r.prototype.mulScalar=function(t){return this.x*=t,this.y*=t,this},r.prototype.divScalar=function(t){return this.x/=t,this.y/=t,this},r.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},r.prototype.directionTo=function(t){return new r(t).sub(this).normalise()},r.prototype.lerp=function(r,i,n){return this.x=t(r.x,i.x,n),this.y=t(r.y,i.y,n),this},r.prototype.angle=function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},r.prototype.toJSON=function(){return{x:this.x,y:this.y}},r.prototype.toString=function(){return"{x:"+this.x+", y:"+this.y+"}"},r.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},r.memoizedOneArgDeriver=function(t,i){var n=new r,o=null;return function(){var e=t();return null!=o&&n.equals(e)?o:(n.copyFrom(e),o=new r,i(e,o),o)}},r.memoizedZeroArgDeriver=function(t){var r=null;return function(){return null==r&&(r=t()),r}},r}();exports.Vec2d=r;
},{}],"pLDY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Vec2d"),t=1,o=function(){function o(){this.offset=new e.Vec2d}return o.prototype.toScreen=function(e){return e.clone().mulScalar(t).sub(this.offset)},o.prototype.fromScreen=function(e){return e.clone().add(this.offset).divScalar(t)},o.prototype.getScreenPos=function(e){var t=this.getScreenSpacePosition(e);return this.toScreen(t)},o.prototype.getScreenSpacePosition=function(t){return new e.Vec2d({x:Math.floor(t.x),y:-Math.floor(t.y+t.z/2)})},o.prototype.update=function(t,n,r){var i=new e.Vec2d(this.getScreenSpacePosition(t));this.offset.x+=o.calculateViewAdjustmentForDimension(this.offset.x,n,i.x),this.offset.y+=o.calculateViewAdjustmentForDimension(this.offset.y,r,i.y)},o.calculateViewAdjustmentForDimension=function(e,t,n){var r=Math.floor(t*(o.VIEWBOX_PADDING_PCT/100)),i=e+r,c=e+t-r,s=Math.min(n-i,0),f=-Math.min(c-n,0);return 0===s?f:s},o.VIEWBOX_PADDING_PCT=20,o}();exports.View=o;
},{"./Vec2d":"bVh3"}],"jKSw":[function(require,module,exports) {
"use strict";var e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./Player"),r=require("./Background"),i=e(require("./utils")),s=require("./Input"),n=require("./Physics"),o=require("./View"),u=require("./assets"),h=50,a=i.getCanvas(),p=document.getElementById("debug"),c=function(){function e(){this.realFrameNumber=0,this.frameNumber=0,this.input=new s.Input,this.player=new t.Player,this.physics=new n.Physics,this.worldObjects=[],this.view=new o.View;var e=new r.Background(u.sewerAnim);e.position.x=-90,this.physics.bodies.push(this.player.physBody),this.worldObjects.push(this.player,e)}return e.prototype.update=function(){var e=this,t=performance.now();this.input.update(),this.worldObjects.forEach(function(t){return t.update(e)}),this.physics.step(t),this.view.update(this.player.position,a.width,a.height)},e.prototype.render=function(){var e=this,t=a.getContext("2d");if(!t)throw new Error("couldn't get canvas context");if(this.realFrameNumber++,this.realFrameNumber%4==0){this.frameNumber++,t.fillStyle="white",t.fillRect(0,0,a.width,a.height);var r=this.worldObjects.slice().sort(function(e,t){return e.zLayer-t.zLayer});r.forEach(function(r){return r.render(e,t)}),r.forEach(function(r){return r.renderDebug(e,t)}),p&&(p.textContent=JSON.stringify({view:this.view.offset,phys:{pos:this.player.physBody.position,vel:this.player.physBody.nonIntegralVelocity,acc:this.player.physBody.nonIntegralAcceleration}},null,2))}},e.prototype.getScreenPos=function(e){return this.view.getScreenPos(e.position)},e}();exports.Game=c;
},{"./Player":"lbff","./Background":"zFH5","./utils":"UnXq","./Input":"tde3","./Physics":"gTgb","./View":"pLDY","./assets":"SLDe"}],"QCba":[function(require,module,exports) {
"use strict";var e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./Game"),n=require("./assets"),r=e(require("./utils"));Object.entries(n.images).forEach(function(e){e[0];var t=e[1];return r.getImage(t)});var i=new t.Game;function u(){requestAnimationFrame(function(){i.update(),i.render(),u()})}window.game=i,document.addEventListener("keydown",function(e){e.repeat||i.input.onKeyDown(e.key)}),document.addEventListener("keyup",function(e){i.input.onKeyUp(e.key)}),u();
},{"./Game":"jKSw","./assets":"SLDe","./utils":"UnXq"}]},{},["QCba"], null)
//# sourceMappingURL=/punchface/punchface.ac7ccd2f.js.map